@model IEnumerable<MVC.Models.DepartmentListViewModel>

@foreach (var item in Model)
{
    <tr class="@(item.IsActive ? "" : "table-secondary")" data-department-id="@item.Id">
        <td>
            @{
                string indent = "";
                for (int i = 0; i < item.Level; i++)
                {
                    indent += "&nbsp;&nbsp;&nbsp;&nbsp;";
                }
            }
            @Html.Raw(indent)
            @if (item.Level > 0)
            {
                <i class="fas fa-arrow-right text-muted me-1"></i>
            }
            @if (item.HasChildren)
            {
                <i class="fas fa-folder text-warning me-1"></i>
            }
            else
            {
                <i class="fas fa-folder-open text-info me-1"></i>
            }
            <span class="department-name">@Html.DisplayFor(modelItem => item.Name)</span>
        </td>
        <td>
            <span class="department-description">@Html.DisplayFor(modelItem => item.Description)</span>
        </td>
        <td>
            @if (!string.IsNullOrEmpty(item.ParentDepartmentName))
            {
                <span class="badge bg-secondary">@item.ParentDepartmentName</span>
            }
            else
            {
                <span class="text-muted">Ana Departman</span>
            }
        </td>
        <td>
            <a asp-action="Employees" asp-route-id="@item.Id" class="btn btn-sm btn-outline-primary">
                @item.EmployeeCount <i class="fas fa-users"></i>
            </a>
        </td>
        <td>
            @if (item.IsActive)
            {
                <span class="badge bg-success">Aktif</span>
            }
            else
            {
                <span class="badge bg-secondary">Pasif</span>
            }
        </td>
        <td>
            <div class="btn-group" role="group">
                <a asp-action="Details" asp-route-id="@item.Id" class="btn btn-info btn-sm" title="Detay">
                    <i class="fas fa-eye"></i>
                </a>
                <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-warning btn-sm" title="Düzenle">
                    <i class="fas fa-edit"></i>
                </a>
                @if (item.IsActive)
                {
                    <form asp-action="ToggleStatus" method="post" style="display: inline;">
                        <input type="hidden" name="id" value="@item.Id" />
                        <input type="hidden" name="isActive" value="false" />
                        <button type="submit" class="btn btn-secondary btn-sm" title="Pasif Yap" 
                                onclick="return confirm('Bu departmanı pasif yapmak istediğinize emin misiniz?')">
                            <i class="fas fa-ban"></i>
                        </button>
                    </form>
                }
                else
                {
                    <form asp-action="ToggleStatus" method="post" style="display: inline;">
                        <input type="hidden" name="id" value="@item.Id" />
                        <input type="hidden" name="isActive" value="true" />
                        <button type="submit" class="btn btn-success btn-sm" title="Aktif Yap">
                            <i class="fas fa-check"></i>
                        </button>
                    </form>
                }
                <a asp-action="Delete" asp-route-id="@item.Id" class="btn btn-danger btn-sm" title="Sil">
                    <i class="fas fa-trash"></i>
                </a>
            </div>
        </td>
    </tr>
}
